---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import PageHero from '../../components/PageHero.astro';

const projectSpotlights = await getCollection('project-spotlights');
const mentorInterviews = await getCollection('mentor-interviews');
const communityUpdates = await getCollection('community-updates');

const posts = [
  ...projectSpotlights.map((post) => ({
    ...post,
    category: 'Project Spotlight',
    href: `/blog/project-spotlights/${post.slug}`
  })),
  ...mentorInterviews.map((post) => ({
    ...post,
    category: 'Mentor Interview',
    href: `/blog/mentor-interviews/${post.slug}`
  })),
  ...communityUpdates.map((post) => ({
    ...post,
    category: 'Community Update',
    href: `/blog/community-updates/${post.slug}`
  }))
].sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime());
---

<BaseLayout title="Blog" description="Project spotlights, mentor interviews, and community updates from B3.">
  <PageHero
    eyebrow="Blog"
    title="Project Spotlights and Community Stories"
    lead="A markdown-powered content hub for kid projects, mentor interviews, and Cedar Park/Austin community updates."
  />

  <section class="mx-auto max-w-5xl space-y-4 px-4 py-12 sm:px-6 lg:px-8">
    {posts.map((post) => (
      <article class="rounded-2xl border border-white/10 bg-white/5 p-6 shadow-glow">
        <p class="text-sm font-bold uppercase tracking-[0.15em] text-circuit">{post.category}</p>
        <h2 class="mt-2 text-2xl font-black"><a href={post.href} class="hover:text-builder">{post.data.title}</a></h2>
        <p class="mt-3 text-slate-300">{post.data.excerpt}</p>
        <p class="mt-4 text-sm text-slate-400">{post.data.publishDate.toLocaleDateString('en-US', { dateStyle: 'long' })}</p>
      </article>
    ))}
  </section>
</BaseLayout>
